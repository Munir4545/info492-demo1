(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,60566,e=>{"use strict";e.s(["default",()=>f],60566);var t=e.i(23695),s=e.i(69163),a=e.i(71586),l=e.i(35493),n=e.i(41522),r=e.i(7811),i=e.i(26053),o=e.i(33451),d=e.i(74739),c=e.i(61242);function x(e){let{selectedDriver:t}=e,a=(0,d.useLeafletContext)().map;return(0,s.useEffect)(()=>{t&&a.setView([t.location.lat,t.location.lng],11,{animate:!0,duration:1})},[t,a]),null}delete c.default.Icon.Default.prototype._getIconUrl,c.default.Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"});let p=e=>c.default.divIcon({className:"custom-marker",html:'\n      <div style="\n        background-color: '.concat(e,';\n        width: 24px;\n        height: 24px;\n        border-radius: 50%;\n        border: 3px solid white;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n      "></div>\n    '),iconSize:[24,24],iconAnchor:[12,12]}),m=p("#3b82f6"),h=p("#10b981"),u=p("#64748b"),g=p("#9333ea"),b=c.default.divIcon({className:"custom-marker",html:'\n    <div style="position: relative;">\n      <div style="\n        position: absolute;\n        width: 32px;\n        height: 32px;\n        border-radius: 50%;\n        background-color: rgba(239, 68, 68, 0.3);\n        animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n      "></div>\n      <div style="\n        background-color: #ef4444;\n        width: 24px;\n        height: 24px;\n        border-radius: 50%;\n        border: 3px solid white;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n        position: relative;\n        z-index: 10;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        color: white;\n        font-size: 14px;\n        font-weight: bold;\n      ">⚠</div>\n    </div>\n    <style>\n      @keyframes pulse {\n        0%, 100% {\n          opacity: 1;\n          transform: translate(-50%, -50%) scale(1);\n        }\n        50% {\n          opacity: 0;\n          transform: translate(-50%, -50%) scale(1.5);\n        }\n      }\n    </style>\n  ',iconSize:[32,32],iconAnchor:[16,16]});function f(e){let{drivers:s,selectedDriver:d,onDriverSelect:p}=e,f=(e,t)=>{let s=[.01,.02,-.01,.015],a=[.015,-.01,.02,-.015];return{lat:e.location.lat+(s[t%s.length]||0),lng:e.location.lng+(a[t%a.length]||0)}};return(0,t.jsxs)("div",{className:"relative w-full h-[500px] rounded-lg overflow-hidden shadow-lg border border-slate-200 dark:border-slate-700",children:[(0,t.jsxs)(a.MapContainer,{center:[47.2,-120],zoom:7,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,children:[(0,t.jsx)(l.TileLayer,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,t.jsx)(x,{selectedDriver:d}),s.map(e=>(0,t.jsx)(n.Marker,{position:[e.location.lat,e.location.lng],icon:(e=>{if(e.isGpsCompromised)return b;switch(e.status){case"En Route":default:return m;case"Delivering":return h;case"Loading":return u;case"Completed":return g}})(e),eventHandlers:{click:()=>p(e)},children:(0,t.jsx)(r.Popup,{children:(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("p",{className:"font-bold text-slate-800",children:[e.isGpsCompromised&&"⚠️ ",e.name]}),(0,t.jsx)("p",{className:"text-slate-600",children:e.id}),(0,t.jsx)("p",{className:"text-slate-600",children:e.zone}),e.isGpsCompromised&&(0,t.jsxs)("div",{className:"mt-2 p-2 bg-red-50 rounded",children:[(0,t.jsx)("p",{className:"text-red-700 font-semibold text-xs",children:"GPS COMPROMISED"}),(0,t.jsx)("p",{className:"text-red-600 text-xs",children:"Location data unreliable"})]}),(0,t.jsx)("p",{className:"mt-2",children:(0,t.jsx)("span",{className:"inline-block px-2 py-1 rounded text-xs font-medium ".concat(e.isGpsCompromised?"bg-red-100 text-red-700":"En Route"===e.status?"bg-blue-100 text-blue-700":"Delivering"===e.status?"bg-green-100 text-green-700":"Completed"===e.status?"bg-purple-100 text-purple-700":"bg-slate-200 text-slate-700"),children:e.status})}),(0,t.jsxs)("p",{className:"text-slate-600 mt-1",children:[e.packages," packages"]}),(0,t.jsx)("button",{className:"mt-2 text-xs text-blue-600 hover:text-blue-800 font-medium",onClick:t=>{t.stopPropagation(),p(e)},children:"View Route Details →"})]})})},e.id)),d&&d.route&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Polyline,{positions:[[d.location.lat,d.location.lng],...d.route.map((e,t)=>{let s=f(d,t);return[s.lat,s.lng]})],pathOptions:{color:"#3b82f6",weight:3,opacity:.7,dashArray:"10, 5"}}),d.route.map((e,s)=>{var a,l;let i=f(d,s);return(0,t.jsxs)("div",{children:[e.isSpoofed&&(0,t.jsx)(o.Circle,{center:[i.lat,i.lng],radius:500,pathOptions:{color:"#ef4444",fillColor:"#ef4444",fillOpacity:.2,weight:2,dashArray:"5, 5"}}),(0,t.jsx)(n.Marker,{position:[i.lat,i.lng],icon:(a=e.status,l=s+1,c.default.divIcon({className:"custom-stop-marker",html:'\n      <div style="\n        background-color: '.concat({completed:"#10b981","in-progress":"#3b82f6",pending:"#94a3b8"}[a],';\n        width: 28px;\n        height: 28px;\n        border-radius: 50%;\n        border: 3px solid white;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        color: white;\n        font-weight: bold;\n        font-size: 12px;\n      ">').concat(l,"</div>\n    "),iconSize:[28,28],iconAnchor:[14,14]})),children:(0,t.jsx)(r.Popup,{children:(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("p",{className:"font-bold text-slate-800",children:["Stop #",s+1]}),(0,t.jsx)("p",{className:"text-slate-600 text-xs mt-1",children:e.address}),(0,t.jsx)("p",{className:"mt-2",children:(0,t.jsx)("span",{className:"inline-block px-2 py-1 rounded text-xs font-medium ".concat("completed"===e.status?"bg-green-100 text-green-700":"in-progress"===e.status?"bg-blue-100 text-blue-700":"bg-slate-200 text-slate-700"),children:e.status.toUpperCase()})}),(0,t.jsxs)("p",{className:"text-slate-600 mt-1",children:[e.packages," packages"]}),e.eta&&(0,t.jsxs)("p",{className:"text-slate-600 text-xs mt-1",children:["ETA: ",e.eta]})]})})}),"in-progress"===e.status&&(0,t.jsx)(o.Circle,{center:[i.lat,i.lng],radius:300,pathOptions:{color:"#3b82f6",fillColor:"#3b82f6",fillOpacity:.1,weight:2}})]},"".concat(d.id,"-stop-").concat(s))})]})]}),(0,t.jsxs)("div",{className:"absolute bottom-4 left-4 bg-white dark:bg-slate-800 rounded-lg shadow-lg p-4 border border-slate-200 dark:border-slate-700 z-[1000]",children:[(0,t.jsx)("h3",{className:"text-sm font-bold text-slate-800 dark:text-white mb-2",children:d?"".concat(d.name,"'s Route"):"Fleet Status"}),(0,t.jsx)("div",{className:"space-y-2",children:d?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 rounded-full bg-green-500 border-2 border-white"}),(0,t.jsx)("span",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Completed"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 rounded-full bg-blue-500 border-2 border-white"}),(0,t.jsx)("span",{className:"text-xs text-slate-600 dark:text-slate-400",children:"In Progress"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 rounded-full bg-slate-500 border-2 border-white"}),(0,t.jsx)("span",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Pending"})]}),(0,t.jsx)("div",{className:"mt-2 pt-2 border-t border-slate-200 dark:border-slate-700",children:(0,t.jsxs)("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:[d.route.filter(e=>"completed"!==e.status).length," stops remaining"]})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 rounded-full bg-blue-500 border-2 border-white"}),(0,t.jsx)("span",{className:"text-xs text-slate-600 dark:text-slate-400",children:"En Route"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 rounded-full bg-green-500 border-2 border-white"}),(0,t.jsx)("span",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Delivering"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 rounded-full bg-slate-500 border-2 border-white"}),(0,t.jsx)("span",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Loading"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 rounded-full bg-purple-500 border-2 border-white"}),(0,t.jsx)("span",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Completed"})]})]})})]})]})}},91426,e=>{e.n(e.i(60566))}]);